<div class="highlight"><pre><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RegistryService</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="cm">/**</span>
<span class="cm"> * 注册数据，比如：提供者地址，消费者地址，路由规则，覆盖规则，等数据。</span>
<span class="cm"> * </span>
<span class="cm"> * 注册需处理契约：&amp;lt;br&amp;gt;</span>
<span class="cm"> * 1. 当URL设置了check=false时，注册失败后不报错，在后台定时重试，否则抛出异常。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 2. 当URL设置了dynamic=false参数，则需持久存储，否则，当注册者出现断电等情况异常退出时，需自动删除。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 3. 当URL设置了category=routers时，表示分类存储，缺省类别为providers，可按分类部分通知数据。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 4. 当注册中心重启，网络抖动，不能丢失数据，包括断线自动删除数据。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 5. 允许URI相同但参数不同的URL并存，不能覆盖。&amp;lt;br&amp;gt;</span>
<span class="cm"> * </span>
<span class="cm"> * @param url 注册信息，不允许为空，如：dubbo://10.20.153.10/com.alibaba.foo.BarService?version=1.0.0&amp;amp;application=kylin</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">register</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">);</span>

<span class="cm">/**</span>
<span class="cm"> * 取消注册.</span>
<span class="cm"> * </span>
<span class="cm"> * 取消注册需处理契约：&amp;lt;br&amp;gt;</span>
<span class="cm"> * 1. 如果是dynamic=false的持久存储数据，找不到注册数据，则抛IllegalStateException，否则忽略。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 2. 按全URL匹配取消注册。&amp;lt;br&amp;gt;</span>
<span class="cm"> * </span>
<span class="cm"> * @param url 注册信息，不允许为空，如：dubbo://10.20.153.10/com.alibaba.foo.BarService?version=1.0.0&amp;amp;application=kylin</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">unregister</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">);</span>

<span class="cm">/**</span>
<span class="cm"> * 订阅符合条件的已注册数据，当有注册数据变更时自动推送.</span>
<span class="cm"> * </span>
<span class="cm"> * 订阅需处理契约：&amp;lt;br&amp;gt;</span>
<span class="cm"> * 1. 当URL设置了check=false时，订阅失败后不报错，在后台定时重试。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 2. 当URL设置了category=routers，只通知指定分类的数据，多个分类用逗号分隔，并允许星号通配，表示订阅所有分类数据。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 3. 允许以interface,group,version,classifier作为条件查询，如：interface=com.alibaba.foo.BarService&amp;amp;version=1.0.0&amp;lt;br&amp;gt;</span>
<span class="cm"> * 4. 并且查询条件允许星号通配，订阅所有接口的所有分组的所有版本，或：interface=*&amp;amp;group=*&amp;amp;version=*&amp;amp;classifier=*&amp;lt;br&amp;gt;</span>
<span class="cm"> * 5. 当注册中心重启，网络抖动，需自动恢复订阅请求。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 6. 允许URI相同但参数不同的URL并存，不能覆盖。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 7. 必须阻塞订阅过程，等第一次通知完后再返回。&amp;lt;br&amp;gt;</span>
<span class="cm"> * </span>
<span class="cm"> * @param url 订阅条件，不允许为空，如：consumer://10.20.153.10/com.alibaba.foo.BarService?version=1.0.0&amp;amp;application=kylin</span>
<span class="cm"> * @param listener 变更事件监听器，不允许为空</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">subscribe</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">,</span> <span class="n">NotifyListener</span> <span class="n">listener</span><span class="o">);</span>

<span class="cm">/**</span>
<span class="cm"> * 取消订阅.</span>
<span class="cm"> * </span>
<span class="cm"> * 取消订阅需处理契约：&amp;lt;br&amp;gt;</span>
<span class="cm"> * 1. 如果没有订阅，直接忽略。&amp;lt;br&amp;gt;</span>
<span class="cm"> * 2. 按全URL匹配取消订阅。&amp;lt;br&amp;gt;</span>
<span class="cm"> * </span>
<span class="cm"> * @param url 订阅条件，不允许为空，如：consumer://10.20.153.10/com.alibaba.foo.BarService?version=1.0.0&amp;amp;application=kylin</span>
<span class="cm"> * @param listener 变更事件监听器，不允许为空</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">unsubscribe</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">,</span> <span class="n">NotifyListener</span> <span class="n">listener</span><span class="o">);</span>

<span class="cm">/**</span>
<span class="cm"> * 查询符合条件的已注册数据，与订阅的推模式相对应，这里为拉模式，只返回一次结果。</span>
<span class="cm"> * </span>
<span class="cm"> * @see com.alibaba.dubbo.registry.NotifyListener#notify(List)</span>
<span class="cm"> * @param url 查询条件，不允许为空，如：consumer://10.20.153.10/com.alibaba.foo.BarService?version=1.0.0&amp;amp;application=kylin</span>
<span class="cm"> * @return 已注册信息列表，可能为空，含义同{@link com.alibaba.dubbo.registry.NotifyListener#notify(List&amp;lt;URL&amp;gt;)}的参数。</span>
<span class="cm"> */</span>
<span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">URL</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">lookup</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">);</span>
<span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}&lt;/</span><span class="n">p</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</pre></div>